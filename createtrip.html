<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <link rel="stylesheet" href="createtrip.css">
    
    <div id="step1" class="step active">
        <div class="grey-rect">
            <div class="desc-img">
                <p class="dir-desc">Откуда</p>
                <img src="images/location-pin-alt-svgrepo-com.svg" class="dir-image">
            </div>
            <!-- <p class="dir-choose">Выберите город:</p> -->
            <div class="but-text">
                <div class="buttons">
                    <button class="button1" id="left1" onclick="selectOrigin('Иннополис', 'left1')">Иннополис</button>
                    <button class="button1" id="right1" onclick="selectOrigin('Казань', 'right1')">Казань</button>
                </div>
                <textarea id="comment1" class="com" placeholder="Уточните место отправления..."></textarea>
            </div>
            <button class="next" onclick="addInfoOrigin()">Далее</button>
        </div>
    </div>

    <div id="step2" class="step">
        <div class="grey-rect">
            <div class="desc-img">
                <p class="dir-desc">Куда</p>
                <img src="images/location-xmark-svgrepo-com.svg" class="dir-image">
            </div>
            <!-- <p class="dir-choose">Выберите город:</p> -->
            <div class="but-text">
                <div class="buttons">
                    <button class="button2" id="left2" onclick="selectDestination('Иннополис', 'left2')">Иннополис</button>
                    <button class="button2" id="right2" onclick="selectDestination('Казань', 'right2')">Казань</button>
                </div>
                <textarea id="comment2" class="com" placeholder="Уточните место прибытия..."></textarea>
            </div>
            <div class="nav-buttons">
                <button class="next" id="dir-button1" onclick="goBack(2)">Назад</button>
                <button class="next" id="dir-button2" onclick="addInfoDest()">Далее</button>
            </div>
        </div>
    </div>

    <div id="step3" class="step">
        <img src="images/date-range-svgrepo-com.svg" class="date-img">
        <div class="grey-rect">
            <div class="desc-img">
                <p class="dir-desc">Дата и время поездки</p>
            </div>
            <div class="date">
                <p class="choose-dt">Выберите дату:</p>
                <input type="date" id="date-f" value="2024-06-23"></input>
            </div>
            <div class="time">
                <p class="choose-dt">Выберите время:</p>
                <input type="time" id="time-f" value="00:00"></input>
            </div>
            <div class="nav-buttons">
                <button class="next" id="dir-button1" onclick="goBack(3)">Назад</button>
                <button class="next" id="dir-button2" onclick="selectDate()">Далее</button>
            </div>
        </div>
    </div>

    <div id="step4" class="step">
        <img src="images/ruble-svgrepo-com.svg" class="date-img">
        <div class="grey-rect">
            <div class="desc-img">
                <p class="dir-desc">Вид и цена поездки</p>
            </div>
            <div class="type">
                <ul class="choice">
                    <li>
                        <label for="own">
                            <input  type="radio" id="own" name="r">
                            <div class="checkbox__checkmark"></div>
                            На своей машине
                        </label>
                    </li>
                    <li>
                        <label for="carsh">
                            <input  type="radio" id="carsh" name="r">
                            <div class="checkbox__checkmark"></div>
                            Каршеринг
                        </label>
                    </li>
                    <li>
                        <label for="taxi">
                            <input  type="radio" id="taxi" name="r">
                            <div class="checkbox__checkmark"></div>
                            Совместное такси
                        </label>
                    </li>
                </ul>
            </div>
            
            <div class="price">
                <p class="choose-price">Цена в рублях:</p>
                <input type="number" id="price-rub" value="100" step="50" min="0">
            </div>
            <div class="nav-buttons">
                <button class="next" id="dir-button1" onclick="goBack(4)">Назад</button>
                <button class="next" id="dir-button2" onclick="goToStep(5)">Далее</button>
            </div>
        </div>
    </div>

    <div id="step5" class="step">
        <img src="images/travel-car-svgrepo-com.svg" class="car-img">
        <div class="grey-rect">
            <div class="desc-img">
                <p class="dir-desc">Выберите машину</p>
            </div>
            <div class="car">
                <ul class="choice">
                    <li>
                        <label for="car1">
                            <input  type="radio" id="car1" name="c">
                            <div class="checkbox__checkmark"></div>
                            машина 1
                        </label>
                    </li>
                    <li>
                        <label for="car2">
                            <input  type="radio" id="car2" name="c">
                            <div class="checkbox__checkmark"></div>
                            машина 2
                        </label>
                    </li>
                    <li>
                        <label for="car3">
                            <input  type="radio" id="car3" name="c">
                            <div class="checkbox__checkmark"></div>
                            машина 3
                        </label>
                    </li>
                </ul>
            </div>
            <div class="nav-buttons">
                <button class="next" id="dir-button1" onclick="goBack(5)">Назад</button>
                <button class="next" id="dir-button2" onclick="goToStep(6)">Далее</button>
            </div>
        </div>
    </div>

    <div id="step6" class="step">
        <div class="grey-rect">
            <div class="header">
                <p id="param-text">Параметры</p>
                <hr id="hr">
            </div>
            <ul class="choice" id="param">
                <li class="param-li">
                    <label for="lag" >
                        <input  type="checkbox" id="lag">
                        <div class="checkbox__checkmark"></div>
                        Есть место для багажа
                    </label>
                </li>
                <li class="param-li" >
                    <label for="an">
                        <input  type="checkbox" id="an">
                        <div class="checkbox__checkmark"></div>
                        Можно с животными
                    </label>
                </li>
                <li class="param-li" >
                    <label for="ch">
                        <input  type="checkbox" id="ch">
                        <div class="checkbox__checkmark"></div>
                        Есть детское кресло
                    </label>
                </li>
                <li class="param-li" >
                    <label for="bu">
                        <input  type="checkbox" id="bu">
                        <div class="checkbox__checkmark"></div>
                        Есть бустер
                    </label>
                </li>
                <li class="param-li" >
                    <div class="av-text">
                        Свободных мест
                        <input type="number" list="places" step="1" min="1" max="4" id="av" class="number-input"/>
                        <datalist id="places">
                            <option value="1">
                            <option value="2">
                            <option value="3">
                            <option value="4">
                        </datalist>
                    </div>
                </li>
            </ul>

            <textarea id="add" class="com" placeholder="Дополнительные сведения о поездке..."></textarea>

            <div class="nav-buttons">
                <button class="next" id="dir-button1" onclick="goBack(6)">Назад</button>
                <button class="next" id="dir-button2" onclick="goToStep(7)">Готово</button>
            </div>
        </div>
    </div>

    <div id="step7" class="step">
        <div class="grey-rect">
            <div class="desc-img" id="sub-d">
                <p class="dir-desc" id="submit-data">Подтвердите данные о поездке</p>
            </div>
            <div id="trip-data">
                    
            </div>
            <div class="nav-buttons">
                <button class="next" id="dir-button1" onclick="goBack(7)">Назад</button>
                <button class="next" id="dir-button2" onclick="submitTrip()">Подтвердить</button>
            </div>
        </div>
    </div>

    <script>

        document.addEventListener('DOMContentLoaded', (event) => {
            const comments = document.querySelectorAll('.com');

            function handleClickOutside(event) {
                comments.forEach(comment => {
                    if (comment === document.activeElement && !comment.contains(event.target)) {
                        comment.blur(); 
                    }
                });
            }

            ['click', 'touchstart', 'touchend', 'touchcancel', 'touchmove'].forEach(eventType => {
                document.addEventListener(eventType, handleClickOutside);
            });
        });

        let tripData = {
            origin: '',
            destination: '',
            addInfoDest: '',
            addInfoOrigin: '',
            date: '',
            time: '',
            type: '',
            price: '',
            car: '',
            lagg: false,
            an: false,
            ch: false,
            bust: false,
            av: '',
            additional: ''
        };

        function updateTripData() {
            const tripDataDiv = document.getElementById('trip-data');
            tripDataDiv.innerHTML = `
                <p>Откуда: ${tripData.origin} (${tripData.addInfoOrigin})</p>
                <p>Куда: ${tripData.destination} (${tripData.addInfoDest})</p>
                <p>Дата и время: ${tripData.date}</p>
            `;
        }

        function selectOrigin(city, id) {
            tripData.origin = city;
            const button = document.getElementById(id);
            if (button.classList.contains('selected')) {
                button.classList.remove('selected');
                button.style.backgroundColor = ''; 
            } else {
                document.querySelectorAll('.button1').forEach(btn => {
                    btn.classList.remove('selected');
                    btn.style.backgroundColor = '';
                });
        
                button.classList.add('selected');
                button.style.backgroundColor = '#969696';
            }
            updateTripData()
        }

        function selectDestination(city, id) {
            tripData.destination = city;
            const button = document.getElementById(id);
            if (button.classList.contains('selected')) {
                button.classList.remove('selected');
                button.style.backgroundColor = ''; 
            } else {
                document.querySelectorAll('.button2').forEach(btn => {
                    btn.classList.remove('selected');
                    btn.style.backgroundColor = '';
                });
        
                button.classList.add('selected');
                button.style.backgroundColor = '#969696';
            }
            updateTripData()
        }

        function addInfoOrigin() {
            let input = document.getElementById('comment1');
            tripData.addInfoOrigin = input.value;
            goToStep(2);
            updateTripData()
        }

        function addInfoDest() {
            let input = document.getElementById('comment2');
            tripData.addInfoDest = input.value;
            goToStep(3);
            updateTripData()
        }

        function selectDate() {
            let date = document.getElementById('date-f');
            let time = document.getElementById('time-f');
            tripData.date = `${date.value}   ${time.value}`;
            goToStep(4);
            updateTripData()
        }

        function selectTypePrice(date) {
            tripData.date = date;
        }

        function selectCar(date) {
            tripData.date = date;
        }

        function goBack(cuurent) {
            goToStep(cuurent - 1);
        }

        function showSummary() {
            document.getElementById('summary-text').innerText = `Город отправления: ${tripData.origin}, Город назначения: ${tripData.destination}, Дата поездки: ${tripData.date}`;
        }

        function submitTrip() {
            window.location.href = "tripcreated.html";
            console.log('Trip submitted:', tripData);
        }

        function goToStep(step) {
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
        }
    </script>
</body>
</html>
